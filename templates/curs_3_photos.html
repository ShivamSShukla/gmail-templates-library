<!DOCTYPE html>
<html lang="uk" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${pageTitle}">Фотогалерея</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        nav ul { list-style: none; padding: 0; margin: 20px 0; background-color: #f2f2f2; overflow: hidden; }
        nav li { float: left; }
        nav li a {
            display: block;
            color: #333;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
        }
        nav li a:hover { background-color: #ddd; color: black; }
        .photo-gallery { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px; }
        .photo-card { border: 1px solid #ddd; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .photo-card img { width: 100%; height: 200px; object-fit: cover; display: block; }
        .photo-card-content { padding: 15px; }
        .photo-card-content h3 { margin-top: 0; font-size: 1.2em; color: #333; }
        .photo-card-content p { font-size: 0.9em; color: #666; margin-bottom: 5px; }
        .photo-card-content small { font-size: 0.8em; color: #999; }
        .delete-photo-btn {
            background-color: #d87984; /* Червоний колір для кнопки видалення */
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px; /* Відступ від тексту */
        }
        .delete-photo-btn:hover {
            background-color: #fbfbd7;
        }
        .photo-actions {
            display: flex;
            justify-content: flex-end; /* Вирівнюємо кнопку праворуч */
            padding-top: 10px;
        }
    </style>
</head>
<body>
<nav>
    <ul>
        <li><a href="/dashboard">Головна</a></li>
        <li><a href="/about">Про нас</a></li>
        <li><a href="/teachers">Вихователі</a></li>
        <li><a href="/program">Програма</a></li>
        <li><a href="/photos">Фото</a></li>
        <li><a href="/contacts">Контакти</a></li>
    </ul>
</nav>
<div class="container">
    <h1 th:text="${pageTitle}">Фотогалерея</h1>

    <h2>Наші Моменти Щастя в "Ромашці"</h2>
    <p>Зазирніть у яскраві миті життя нашого дитячого садка! Тут ми збираємо найцінніші спогади: перші кроки,
        щирі усмішки, захоплюючі ігри, творчі заняття та веселі свята. Кожна фотографія — це частинка радості,
        що відображає атмосферу любові та розвитку, яка панує у "Ромашці".</p>
    <p>Насолоджуйтесь нашими фотографіями та відчуйте тепло нашої дружньої родини!</p>

    <div th:if="${successMessage}" class="message success" th:text="${successMessage}"></div>
    <div th:if="${errorMessage}" class="message error" th:text="${errorMessage}"></div>

    <div th:if="${#lists.isEmpty(allPhotos)}">
        <p>Наразі жодних фотографій не завантажено. Будьте першими, хто додасть яскраві моменти!</p>
    </div>

    <div th:unless="${#lists.isEmpty(allPhotos)}" class="photo-gallery">
        <div th:each="photo : ${allPhotos}" class="photo-card">
            <img th:src="@{'/uploads/' + ${photo.filename}}" th:alt="${photo.caption ?: 'Фото з Тюльпанчика'}" />
            <div class="photo-card-content">
                <h3 th:text="${photo.caption ?: 'Без підпису'}"></h3>
                <p>Завантажено: <span th:text="${photo.user != null ? photo.user.email : 'Невідомий'}"></span></p>
                <small th:text="${#temporals.format(photo.uploadDate, 'dd-MM-yyyy HH:mm')}"></small>

                <div th:if="${#authentication.principal != null and #authentication.principal.username == (photo.user != null ? photo.user.email : '')}" class="photo-actions">
                    <form th:action="@{/photos/delete}" method="post">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <input type="hidden" name="photoId" th:value="${photo.id}" />
                        <button type="submit" class="delete-photo-btn" onclick="return confirm('Ви впевнені, що хочете видалити це фото?');">Видалити</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>